<div class="course-card col-md-6 col-lg-3 my-3 p5">
  <div class="card height-10 shadow">

    <!--Image Banner-->
    <% if course.image.attached? %>
      <%= image_tag course.image, class: 'card-img-top img-fluid' %>
    <% else %>
      <%= image_tag 'course_image.jpg', class: 'card-img-top' %>
      <div class="centered text-light">
        <%= truncate(course.title, length: 50) %>
      </div>
    <% end %>

    <!--Badges-->

    <span class="badges">

      <% if course_owner?(course) %>

        <!--Unread Messages for Tutors-->
        <% unread_number = find_unread_from_course(course) %>
        <% if unread_number > 0 %>
          <span class="badge badge-primary"><%= pluralize(unread_number, 'message') %></span>
        <% end %>

        <!--Published by Current User-->
        <% if params[:action] == 'index' %>
          <p class="badge badge-success">published by you</p>
        <% end %>

      <% else %>

        <% if subscribing?(course) && course.id != current_user.pending_course %>

          <!--Joined and Reviewed-->
          <p class="badge badge-success">joined</p>
          <% if current_user.review_for(course) %>
            <span class="badge badge-success">reviewed</span>
          <% end %>

        <% end %>

      <% end %>

    </span>

    <div class="card-body p-3">

      <!--Title-->
      <h5 class="title card-title text-capitalize mb-1">
        <strong><%= link_to truncate(course.title, length: 50), course_path(course), class: 'stretched-link' %></strong>
      </h5>

      <small class="tutor">
        <i><%= course.tutor.name %></i>
      </small>

      <!--Price-->
      <h3 class="price float-right">
        <%= number_to_currency(course.price) %>
      </h3>

      <!--Rating-->
      <span class="rating">
        <%= render 'reviews/rating', rating: course.rating %>
        <% unless course.reviews.any? %>
          <small><i>(no reviews yet)</i></small>
        <% end %>
      </span>

      <!--Students-->
      <span class="students card-subtitle ">
        <%= pluralize(course.students.count, 'student') %>
      </span>

    </div>

  </div>
</div>
